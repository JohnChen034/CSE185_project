# Vcall

This is the final project of Group 15 in CSE185 in spring 2023. We build a variant calling tool that is similar to [VarScan](https://varscan.sourceforge.net/)

## Installation instructions

Installation requires `pandas` to be installed. You can install it using pip: 
``` 
pip install pandas 
```
Installation requires `numpy` to be installed. You can install it using pip: 
``` 
pip install numpy 
```
Once you have `pandas` and `numpy` installed, you can install `Vcall` using pip: 
```

```

note: detailed version is in `requirements.txt`. 

## Basic Usage

usage: 
```
Vcall.py [-h] [-mvf MINVARFREQ] MPILEUPFILE
```

To run mypileup on a small test example (using files in this repo):

```
python Vcall.py ./test/trio.mpileup -minvarfreq 0.2
```

note: file directly save to same level as Vcall.py in default, see below for more options

## Options

positional arguments:

  - `MPILEUPFILE`       path to the input mpileup file


  - `-op OUTPATH`, `--out-path OUTPATH`
                        Specify the output path (default: current working directory)


  - `-o OUTPUT`, `--output OUTPUT`
                        Specify the output file name (default: output)  

optional arguments:

  - `-h`,` --help`            show this help message and exit


  - `-mvf MINVARFREQ`, `--min-var-freq MINVARFREQ`
                        minimum frequency threshold for variants (default: 0.2)


  - `-mc MINCOVERAGE`, `--min-coverage MINCOVERAGE`
                        Minimum read depth at a position to make a call (default: 8)


  - `-mr MINREADS`, `--min-reads MINREADS`
                        Minimum supporting reads at a position to call variants (default: 2)


  - `-maq MINAVGQUAL`, `--min-avg-qual MINAVGQUAL`
                        Minimum base quality at a position to count a read (default: 15)


  - `-mffh MINFREQFORHOM`, `--min-freq-for-hom MINFREQFORHOM`
                        Minimum frequency to call homozygote (default: 0.75)


  - `-p PVALUE`, `--p-value PVALUE`
                        p-value threshold for calling variants (default: 0.99)


  - `-sf STRANDFILTER`, `--strand-filter STRANDFILTER`
                        Ignore variants with more than 90 percent support on one strand (default: True)



## File format

The input file format is [`mpileup`](http://www.htslib.org/doc/samtools-mpileup.html), generated by [samtools](http://www.htslib.org/) using `bam` file.

The output file will be in [`VCF`](https://samtools.github.io/hts-specs/VCFv4.2.pdf).

## Contributors:

Kaifu Yang and Jiayu Chen developed this tool, with inspiration from [VarScan](https://varscan.sourceforge.net/) and lab1 from CSE 185 at UCSD.

Email for questions regarding the tool:

Kaifu Yang: kay002@ucsd.edu

Jiayu Chen: jic034@ucsd.edu
